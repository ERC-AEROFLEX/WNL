  361 :  u1l[]=u1[]; vs1l=vs1;
  362 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  363 :  rhs(0:nff-1)+=ru[];
  364 :
  365 :  u1r[]=u22c[]; vs1r=vs22c;
  366 :  u1l[]=u22[]; vs1l=vs22;
  367 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  368 :  rhs(0:nff-1)+=ru[];
  369 :
  370 :  u1r[]=u20[]; vs1r=vs20;
  371 :  u1l[]=u20[]; vs1l=vs20;
  372 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  373 :  ru[]*=0.5;
  374 :  rhs(0:nff-1)+=ru[];
  375 :
  376 :  u1l[]=u20[]; vs1l=vs20;
  377 :  ru[]=vrhsmass(0,fuuppp,tgv=1);
  378 :  rhs(0:nff-1)+=2*real(beta)*ru[];
  379 :
  380 :  rhs(nft-2)=-2*real(beta)*ys20;
  381 :  rhs(nft-1)=-2*real(beta)*vs20;
  382 :
  383 : };
  384 :
  385 :
  386 : cout << "Resolution " << endl;
  387 : sol=A^-1*rhs;
  388 :
  389 :
  390 : {
  391 : fuuppp<complex> [u4,v4,p4,f4,g4];
  392 : u4[]=sol(0:nff-1);
  393 : cout << " ys= " << sol(nft-2) << endl;
  394 : cout << " vs= " << sol(nft-1) << endl;
  395 : cout << " Fy= " << int1d(th,2)(g4) << endl;
  396 : [ur,vr,pr,fr,gr]=[real(u4),real(v4),real(p4),real(f4),real(g4)];
  397 : plot(ur,value=1,wait=1,cmm="Mode4-AAcAAc");
  398 : };
  399 :
  400 : {
  401 : ofstream file(pathwnl+namewnl4AAcAAc);
  402 : file << sol << endl;
  403 : };
  404 :
  405 :
  406 :
  407 : /////////////////////////////////
  408 : ////// Probleme delta AA  -422 //
  409 : /////////////////////////////////
  410 :
  411 : cout << "-- Ordre 4 - Interaction delta AA --" << endl;
  412 :
  413 : Omega=2*omegaA;
  414 :
  415 :
  416 : cout << "Construction matrice" << endl;
  417 :
  418 : {
  419 :  Ass(0,0)=Omega*1i; Ass(1,1)=Omega*1i;
  420 :  if(Omega!=0){ Mff=Omega*Mff; Aff=Aff+Mff;};
  421 :
  422 :  A = [
  423 :   [Aff  , fsu0[] , fsu1[] ] ,
  424 :   [rsu0[]' , Ass(0,0)  , Ass(0,1)  ] ,
  425 :   [rsu1[]' , Ass(1,0)  , Ass(1,1)  ]
  426 :   ];
  427 :
  428 :  if(Omega!=0){Mff=-1*Mff; Aff=Aff+Mff; Mff=(1./Omega)*Mff;};
  429 :
  430 : };
  431 :
  432 : cout << "Factorisation matrice " << endl;
  433 : set(A,solver=sparsesolver);
  434 :
  435 :
  436 : cout << "Construction vecteur " << endl;
  437 :
  438 : {
  439 :  fuuppp<complex> [ru,rv,rp,rf,rg];
  440 :
  441 :  rhs=0.;
  442 :  u1r[]=u311[]; vs1r=vs311;
  443 :  u1l[]=u1[]; vs1l=vs1;
  444 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  445 :  rhs(0:nff-1)=ru[];
  446 :
  447 :  u1l[]=u22[]; vs1l=vs22;
  448 :  ru[]=vrhsmass(0,fuuppp,tgv=1);
  449 :  rhs(0:nff-1)+=2*alpha*ru[];
  450 :
  451 :  rhs(nft-2)=-2*alpha*ys22;
  452 :  rhs(nft-1)=-2*alpha*vs22;
  453 :
  454 : };
  455 :
  456 :
  457 : cout << "Resolution " << endl;
  458 : sol=A^-1*rhs;
  459 :
  460 :
  461 : {
  462 : fuuppp<complex> [u4,v4,p4,f4,g4];
  463 : u4[]=sol(0:nff-1);
  464 : cout << " ys= " << sol(nft-2) << endl;
  465 : cout << " vs= " << sol(nft-1) << endl;
  466 : cout << " Fy= " << int1d(th,2)(g4) << endl;
  467 : [ur,vr,pr,fr,gr]=[real(u4),real(v4),real(p4),real(f4),real(g4)];
  468 : plot(ur,value=1,wait=1,cmm="Mode4-deltaAA");
  469 : };
  470 :
  471 : {
  472 : ofstream file(pathwnl+namewnl4DeltaAA);
  473 : file << sol << endl;
  474 : };
  475 :
  476 :
  477 :
  478 : //////////////////////////////////////
  479 : ////// Probleme   AA AAc -424  //////
  480 : //////////////////////////////////////
  481 :
  482 : cout << "-- Ordre 4 - Interaction AA AAc --" << endl;
  483 :
  484 : cout << "Construction vecteur " << endl;
  485 :
  486 : {
  487 :  fuuppp<complex> [ru,rv,rp,rf,rg];
  488 :
  489 :  rhs=0.;
  490 :
  491 :  u1r[]=u313[]; vs1r=vs313;
  492 :  u1l[]=u1[]; vs1l=vs1;
  493 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  494 :  rhs(0:nff-1)=ru[];
  495 :
  496 :
  497 :  u1r[]=u1c[]; vs1r=vs1c;
  498 :  u1l[]=u33[]; vs1l=vs33;
  499 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  500 :  rhs(0:nff-1)+=ru[];
  501 :
  502 :  u1r[]=u20[]; vs1r=vs20;
  503 :  u1l[]=u22[]; vs1l=vs22;
  504 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  505 :  rhs(0:nff-1)+=ru[];
  506 :
  507 :  u1l[]=u22[]; vs1l=vs22;
  508 :  ru[]=vrhsmass(0,fuuppp,tgv=1);
  509 :  rhs(0:nff-1)+=2*beta*ru[];
  510 :
  511 :  rhs(nft-2)=-2*beta*ys22;
  512 :  rhs(nft-1)=-2*beta*vs22;
  513 :
  514 :
  515 : };
  516 :
  517 : cout << "Resolution " << endl;
  518 : sol=A^-1*rhs;
  519 :
  520 : {
  521 : fuuppp<complex> [u4,v4,p4,f4,g4];
  522 : u4[]=sol(0:nff-1);
  523 : cout << " ys= " << sol(nft-2) << endl;
  524 : cout << " vs= " << sol(nft-1) << endl;
  525 : cout << " Fy= " << int1d(th,2)(g4) << endl;
  526 : [ur,vr,pr,fr,gr]=[real(u4),real(v4),real(p4),real(f4),real(g4)];
  527 : plot(ur,value=1,wait=1,cmm="Mode4-AAAAc");
  528 : };
  529 :
  530 : {
  531 : ofstream file(pathwnl+namewnl4AAAAc);
  532 : file << sol << endl;
  533 : };
  534 :
  535 :
  536 : /////////////////////////////////
  537 : ////// Probleme delta AA  -44 //
  538 : /////////////////////////////////
  539 :
  540 : cout << "-- Ordre 4 - Interaction AAAA --" << endl;
  541 :
  542 : Omega=4*omegaA;
  543 :
  544 :
  545 : cout << "Construction matrice" << endl;
  546 :
  547 : {
  548 :  Ass(0,0)=Omega*1i; Ass(1,1)=Omega*1i;
  549 :  if(Omega!=0){ Mff=Omega*Mff; Aff=Aff+Mff;};
  550 :
  551 :  A = [
  552 :   [Aff  , fsu0[] , fsu1[] ] ,
  553 :   [rsu0[]' , Ass(0,0)  , Ass(0,1)  ] ,
  554 :   [rsu1[]' , Ass(1,0)  , Ass(1,1)  ]
  555 :   ];
  556 :
  557 :  if(Omega!=0){Mff=-1*Mff; Aff=Aff+Mff; Mff=(1./Omega)*Mff;};
  558 :
  559 : };
  560 :
  561 : cout << "Factorisation matrice " << endl;
  562 : set(A,solver=sparsesolver);
  563 :
  564 :
  565 : cout << "Construction vecteur " << endl;
  566 :
  567 : {
  568 :  fuuppp<complex> [ru,rv,rp,rf,rg];
  569 :
  570 :  rhs=0.;
  571 :
  572 :  u1r[]=u33[]; vs1r=vs33;
  573 :  u1l[]=u1c[]; vs1l=vs1c;
  574 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  575 :  rhs(0:nff-1)=ru[];
  576 :
  577 :  u1r[]=u22[]; vs1r=vs22;
  578 :  u1l[]=u22[]; vs1l=vs22;
  579 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  580 :  ru[]*=0.5;
  581 :  rhs(0:nff-1)+=ru[];
  582 :
  583 : };
  584 :
  585 :
  586 : cout << "Resolution " << endl;
  587 : sol=A^-1*rhs;
  588 :
  589 :
  590 : {
  591 : fuuppp<complex> [u4,v4,p4,f4,g4];
  592 : u4[]=sol(0:nff-1);
  593 : cout << " ys= " << sol(nft-2) << endl;
  594 : cout << " vs= " << sol(nft-1) << endl;
  595 : cout << " Fy= " << int1d(th,2)(g4) << endl;
  596 : [ur,vr,pr,fr,gr]=[real(u4),real(v4),real(p4),real(f4),real(g4)];
  597 : plot(ur,value=1,wait=1,cmm="Mode4-AAAA");
  598 : };
  599 :
  600 : {
  601 : ofstream file(pathwnl+namewnl4AAAA);
  602 : file << sol << endl;
  603 : };
  604 :
  605 :  sizestack + 1024 =46160  ( 45136 )
 
-----------------------------------------
--- Re        =  40
--- rhos/rhof =  50
--- omegas    =  0.657
-----------------------------------------
  --  mesh:  Nb of Triangles =  31727, Nb of Vertices 15955
eigA= (-9.29136e-006,0.662728)
-- Ordre 4 - Interaction delta AAc --
Construction matrice
  -- Block Matrix NxM = 3x3    nxm  =143231x143231 nb  none zero coef. 2568493
Factorisation matrice
Construction vecteur
Resolution
 ys= (1.40779e-006,1.53899e-020)
 vs= (1.71743e-008,-1.4018e-024)
 Fy= (2.38632e-005,2.60871e-019)
-- Ordre 4 - Interaction AAc AAc --
Construction vecteur
Resolution
 ys= (-6.79062e-008,-1.48813e-022)
 vs= (-1.64918e-011,1.34609e-027)
 Fy= (-1.15107e-006,-2.5225e-021)
-- Ordre 4 - Interaction delta AA --
Construction matrice
  -- Block Matrix NxM = 3x3    nxm  =143231x143231 nb  none zero coef. 2568495
Factorisation matrice
Construction vecteur
Resolution
 ys= (-2.16972e-008,-2.67565e-009)
 vs= (3.58357e-009,-2.78351e-008)
 Fy= (1.03298e-006,1.43104e-007)
-- Ordre 4 - Interaction AA AAc --
Construction vecteur
Resolution
 ys= (4.69447e-010,5.66141e-010)
 vs= (-7.5036e-010,6.20423e-010)
 Fy= (-2.42417e-008,-2.94583e-008)
-- Ordre 4 - Interaction AAAA --
Construction matrice
  -- Block Matrix NxM = 3x3    nxm  =143231x143231 nb  none zero coef. 2568495
Factorisation matrice
Construction vecteur
Resolution
 ys= (3.12141e-012,-3.04511e-012)
 vs= (8.07231e-012,8.27459e-012)
 Fy= (-8.08484e-010,7.88719e-010)
times: compile 0.694s, execution 102.191s,  mpirank:0
 ######## We forget of deleting   1023 Nb pointer,   0Bytes  ,  mpirank 0, memor Ójy leak =0
 CodeAlloc : nb ptr  6234,  size :486744 mpirank: 0
Ok: Normal End
 try getConsole D:\marquet\Desktop\Etudes\SpringCylinder-WNL\wnl-wbc\Codes-wnl\F ÓjS-ordre-4.edp
