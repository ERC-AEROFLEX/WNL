  340 :  u1l[]=u20[]; vs1l=vs20;
  341 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  342 :  ru[]*=0.5;
  343 :  rhs(0:nff-1)+=ru[];
  344 :
  345 :  u1l[]=u20[]; vs1l=vs20;
  346 :  ru[]=vrhsmass(0,fuuppp,tgv=1);
  347 :  rhs(0:nff-1)+=2*real(beta)*ru[];
  348 :
  349 :  rhs(nft-2)=-2*real(beta)*ys20;
  350 :  rhs(nft-1)=-2*real(beta)*vs20;
  351 :
  352 : };
  353 :
  354 :
  355 : cout << "Resolution " << endl;
  356 : sol=A^-1*rhs;
  357 :
  358 :
  359 : {
  360 : fuuppp<complex> [u4,v4,p4,f4,g4];
  361 : u4[]=sol(0:nff-1);
  362 : cout << " ys= " << sol(nft-2) << endl;
  363 : cout << " vs= " << sol(nft-1) << endl;
  364 : cout << " Fy= " << int1d(th,2)(g4) << endl;
  365 : [ur,vr,pr,fr,gr]=[real(u4),real(v4),real(p4),real(f4),real(g4)];
  366 : plot(ur,value=1,wait=1,cmm="Mode4-AAcAAc");
  367 : };
  368 :
  369 : {
  370 : ofstream file(pathwnl+namewnl4AAcAAc);
  371 : file << sol << endl;
  372 : };
  373 :
  374 :
  375 :
  376 : /////////////////////////////////
  377 : ////// Probleme delta AA  -422 //
  378 : /////////////////////////////////
  379 :
  380 : cout << "-- Ordre 4 - Interaction delta AA --" << endl;
  381 :
  382 : Omega=2*omegaA;
  383 :
  384 :
  385 : cout << "Construction matrice" << endl;
  386 :
  387 : {
  388 :  Ass(0,0)=Omega*1i; Ass(1,1)=Omega*1i;
  389 :  if(Omega!=0){ Mff=Omega*Mff; Aff=Aff+Mff;};
  390 :
  391 :  A = [
  392 :   [Aff  , fsu0[] , fsu1[] ] ,
  393 :   [rsu0[]' , Ass(0,0)  , Ass(0,1)  ] ,
  394 :   [rsu1[]' , Ass(1,0)  , Ass(1,1)  ]
  395 :   ];
  396 :
  397 :  if(Omega!=0){Mff=-1*Mff; Aff=Aff+Mff; Mff=(1./Omega)*Mff;};
  398 :
  399 : };
  400 :
  401 : cout << "Factorisation matrice " << endl;
  402 : set(A,solver=sparsesolver);
  403 :
  404 :
  405 : cout << "Construction vecteur " << endl;
  406 :
  407 : {
  408 :  fuuppp<complex> [ru,rv,rp,rf,rg];
  409 :
  410 :  rhs=0.;
  411 :  u1r[]=u311[]; vs1r=vs311;
  412 :  u1l[]=u1[]; vs1l=vs1;
  413 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  414 :  rhs(0:nff-1)=ru[];
  415 :
  416 :  u1l[]=u22[]; vs1l=vs22;
  417 :  ru[]=vrhsmass(0,fuuppp,tgv=1);
  418 :  rhs(0:nff-1)+=2*alpha*ru[];
  419 :
  420 :  rhs(nft-2)=-2*alpha*ys22;
  421 :  rhs(nft-1)=-2*alpha*vs22;
  422 :
  423 : };
  424 :
  425 :
  426 : cout << "Resolution " << endl;
  427 : sol=A^-1*rhs;
  428 :
  429 :
  430 : {
  431 : fuuppp<complex> [u4,v4,p4,f4,g4];
  432 : u4[]=sol(0:nff-1);
  433 : cout << " ys= " << sol(nft-2) << endl;
  434 : cout << " vs= " << sol(nft-1) << endl;
  435 : cout << " Fy= " << int1d(th,2)(g4) << endl;
  436 : [ur,vr,pr,fr,gr]=[real(u4),real(v4),real(p4),real(f4),real(g4)];
  437 : plot(ur,value=1,wait=1,cmm="Mode4-deltaAA");
  438 : };
  439 :
  440 : {
  441 : ofstream file(pathwnl+namewnl4DeltaAA);
  442 : file << sol << endl;
  443 : };
  444 :
  445 :
  446 :
  447 : //////////////////////////////////////
  448 : ////// Probleme   AA AAc -424  //////
  449 : //////////////////////////////////////
  450 :
  451 : cout << "-- Ordre 4 - Interaction AA AAc --" << endl;
  452 :
  453 : cout << "Construction vecteur " << endl;
  454 :
  455 : {
  456 :  fuuppp<complex> [ru,rv,rp,rf,rg];
  457 :
  458 :  rhs=0.;
  459 :
  460 :  u1r[]=u313[]; vs1r=vs313;
  461 :  u1l[]=u1[]; vs1l=vs1;
  462 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  463 :  rhs(0:nff-1)=ru[];
  464 :
  465 :
  466 :  u1r[]=u1c[]; vs1r=vs1c;
  467 :  u1l[]=u33[]; vs1l=vs33;
  468 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  469 :  rhs(0:nff-1)+=ru[];
  470 :
  471 :  u1r[]=u20[]; vs1r=vs20;
  472 :  u1l[]=u22[]; vs1l=vs22;
  473 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  474 :  rhs(0:nff-1)+=ru[];
  475 :
  476 :  u1l[]=u22[]; vs1l=vs22;
  477 :  ru[]=vrhsmass(0,fuuppp,tgv=1);
  478 :  rhs(0:nff-1)+=2*beta*ru[];
  479 :
  480 :  rhs(nft-2)=-2*beta*ys22;
  481 :  rhs(nft-1)=-2*beta*vs22;
  482 :
  483 :
  484 : };
  485 :
  486 : cout << "Resolution " << endl;
  487 : sol=A^-1*rhs;
  488 :
  489 : {
  490 : fuuppp<complex> [u4,v4,p4,f4,g4];
  491 : u4[]=sol(0:nff-1);
  492 : cout << " ys= " << sol(nft-2) << endl;
  493 : cout << " vs= " << sol(nft-1) << endl;
  494 : cout << " Fy= " << int1d(th,2)(g4) << endl;
  495 : [ur,vr,pr,fr,gr]=[real(u4),real(v4),real(p4),real(f4),real(g4)];
  496 : plot(ur,value=1,wait=1,cmm="Mode4-AAAAc");
  497 : };
  498 :
  499 : {
  500 : ofstream file(pathwnl+namewnl4AAAAc);
  501 : file << sol << endl;
  502 : };
  503 :
  504 :
  505 : /////////////////////////////////
  506 : ////// Probleme delta AA  -44 //
  507 : /////////////////////////////////
  508 :
  509 : cout << "-- Ordre 4 - Interaction AAAA --" << endl;
  510 :
  511 : Omega=4*omegaA;
  512 :
  513 :
  514 : cout << "Construction matrice" << endl;
  515 :
  516 : {
  517 :  Ass(0,0)=Omega*1i; Ass(1,1)=Omega*1i;
  518 :  if(Omega!=0){ Mff=Omega*Mff; Aff=Aff+Mff;};
  519 :
  520 :  A = [
  521 :   [Aff  , fsu0[] , fsu1[] ] ,
  522 :   [rsu0[]' , Ass(0,0)  , Ass(0,1)  ] ,
  523 :   [rsu1[]' , Ass(1,0)  , Ass(1,1)  ]
  524 :   ];
  525 :
  526 :  if(Omega!=0){Mff=-1*Mff; Aff=Aff+Mff; Mff=(1./Omega)*Mff;};
  527 :
  528 : };
  529 :
  530 : cout << "Factorisation matrice " << endl;
  531 : set(A,solver=sparsesolver);
  532 :
  533 :
  534 : cout << "Construction vecteur " << endl;
  535 :
  536 : {
  537 :  fuuppp<complex> [ru,rv,rp,rf,rg];
  538 :
  539 :  rhs=0.;
  540 :
  541 :  u1r[]=u33[]; vs1r=vs33;
  542 :  u1l[]=u1c[]; vs1l=vs1c;
  543 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  544 :  rhs(0:nff-1)=ru[];
  545 :
  546 :  u1r[]=u22[]; vs1r=vs22;
  547 :  u1l[]=u22[]; vs1l=vs22;
  548 :  ru[]=vrhsf(0,fuuppp,tgv=1);
  549 :  ru[]*=0.5;
  550 :  rhs(0:nff-1)+=ru[];
  551 :
  552 : };
  553 :
  554 :
  555 : cout << "Resolution " << endl;
  556 : sol=A^-1*rhs;
  557 :
  558 :
  559 : {
  560 : fuuppp<complex> [u4,v4,p4,f4,g4];
  561 : u4[]=sol(0:nff-1);
  562 : cout << " ys= " << sol(nft-2) << endl;
  563 : cout << " vs= " << sol(nft-1) << endl;
  564 : cout << " Fy= " << int1d(th,2)(g4) << endl;
  565 : [ur,vr,pr,fr,gr]=[real(u4),real(v4),real(p4),real(f4),real(g4)];
  566 : plot(ur,value=1,wait=1,cmm="Mode4-AAAA");
  567 : };
  568 :
  569 : {
  570 : ofstream file(pathwnl+namewnl4AAAA);
  571 : file << sol << endl;
  572 : };
  573 :
  574 :  sizestack + 1024 =46280  ( 45256 )
 
-----------------------------------------
--- Re        =  40
--- rhos/rhof =  50
--- omegas    =  0.657
-----------------------------------------
  --  mesh:  Nb of Triangles =  42071, Nb of Vertices 21125
--------------------------------------------------------------------------
--------------------------------------------------------------------------
-- Weakly NonLinear Analysis of a cross-stream spring-mounted cylinder --
-- Fourth Order ---------------------------------------------------------
--------------------------------------------------------------------------
-------------------------------------------------------------------------
--- mesh   = 22
--- Re        =  40
--- rhos/rhof =  50
--- gammas    =  0
-------------------------------------------------------
eigA= (-8.0678e-007,0.662755)
-- Ordre 4 - Interaction delta AAc --
Construction matrice
  -- Block Matrix NxM = 3x3    nxm  =189769x189769 nb  none zero coef. 3406532
Factorisation matrice
Construction vecteur
Resolution
 ys= (2.31337e-006,-3.0975e-021)
 vs= (2.48038e-008,2.92424e-023)
 Fy= (3.92135e-005,-5.25051e-020)
-- Ordre 4 - Interaction AAc AAc --
Construction vecteur
Resolution
 ys= (-8.29295e-008,-1.82655e-022)
 vs= (-2.31203e-011,-2.72576e-026)
 Fy= (-1.40572e-006,-3.09615e-021)
-- Ordre 4 - Interaction delta AA --
Construction matrice
  -- Block Matrix NxM = 3x3    nxm  =189769x189769 nb  none zero coef. 3406534
Factorisation matrice
Construction vecteur
Resolution
 ys= (-1.49958e-008,4.31778e-009)
 vs= (-6.07179e-009,-2.10196e-008)
 Fy= (8.99406e-007,-2.61004e-007)
-- Ordre 4 - Interaction AA AAc --
Construction vecteur
Resolution
 ys= (3.42065e-010,2.37957e-010)
 vs= (-3.1487e-010,4.55682e-010)
 Fy= (-1.80393e-008,-1.2328e-008)
-- Ordre 4 - Interaction AAAA --
Construction matrice
  -- Block Matrix NxM = 3x3    nxm  =189769x189769 nb  none zero coef. 3406534
Factorisation matrice
Construction vecteur
Resolution
 ys= (4.97818e-013,-1.45187e-012)
 vs= (3.84893e-012,1.31972e-012)
 Fy= (-1.28952e-010,3.76084e-010)
times: compile 0.864s, execution 148.801s,  mpirank:0
 ######## We forget of deleting   1076 Nb pointer,   0Bytes  ,  mpirank 0, memor{®GázdA3À=v4y leak =0
 CodeAlloc : nb ptr  6369,  size :489848 mpirank: 0
Ok: Normal End
 try getConsole D:\marquet\Desktop\ERC\CODES\WNL\WNL-Order-4.edp
