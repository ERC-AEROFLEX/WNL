  128 :
  129 : complex eig;
  130 :
  131 : {
  132 :  ifstream file(pathmode+namemode);
  133 :  file >> eig ;
  134 :  file >> sol ;
  135 : };
  136 :
  137 : lambdaA=real(eig); omegaA=imag(eig);
  138 : u1[]=sol(0:nff-1); ys1=sol(nft-2); vs1=sol(nft-1);
  139 : [u1c,v1c,p1c,f1c,g1c]=[conj(u1),conj(v1),conj(p1),conj(f1),conj(g1)];
  140 : ys1c=conj(ys1);vs1c=conj(vs1);
  141 :
  142 : cout << "eigA= " << eig << endl;
  143 :
  144 : [ur,vr,pr,fr,gr]=[real(u1),real(v1),real(p1),real(f1),real(g1)];
  145 : plot(ur,value=1,wait=1,cmm="u1-r");
  146 :
  147 : ///////////////////////////////////////
  148 : ///// Ordre2:  Mode AAc - 20   ////////
  149 : ///////////////////////////////////////
  150 :
  151 : {
  152 : ifstream file(pathwnl+namewnl2AAc);
  153 : file >> sol ;
  154 : };
  155 :
  156 : u20[]=sol(0:nff-1); ys20=sol(nft-2); vs20=sol(nft-1);
  157 :
  158 : ///////////////////////////////////////
  159 : ///// Ordre2:  Mode AA - 22    ////////
  160 : ///////////////////////////////////////
  161 :
  162 : {
  163 : ifstream file(pathwnl+namewnl2AA);
  164 : file >> sol ;
  165 : };
  166 :
  167 : u22[]=sol(0:nff-1); ys22=sol(nft-2); vs22=sol(nft-1);
  168 :
  169 : [u22c,v22c,p22c,f22c,g22c]=[conj(u22),conj(v22),conj(p22),conj(f22),conj(g22)];
  170 : ys22c=conj(ys22);vs22c=conj(vs22);
  171 :
  172 :
  173 : ///////////////////////////////////////
  174 : ///// Ordre3:  Mode deltaA  - 311  ////
  175 : ///////////////////////////////////////
  176 :
  177 : {
  178 : ifstream file(pathwnl+namewnl3DeltaA);
  179 : file >> solaug ;
  180 : };
  181 :
  182 : u311[]=solaug(0:nff-1);
  183 : ys311=solaug(nft-2); vs311=solaug(nft-1);
  184 :
  185 :
  186 : [u311c,v311c,p311c,f311c,g311c]=[conj(u311),conj(v311),conj(p311),conj(f311),conj(g311)];
  187 : ys311c=conj(ys311);vs311c=conj(vs311);
  188 :
  189 :
  190 : ///////////////////////////////////////
  191 : ///// Ordre3:  Mode AAAc  - 313  //////
  192 : ///////////////////////////////////////
  193 :
  194 : {
  195 : ifstream file(pathwnl+namewnl3AAAc);
  196 : file >> solaug ;
  197 : };
  198 :
  199 : u313[]=solaug(0:nff-1);
  200 : ys313=solaug(nft-2); vs313=solaug(nft-1);
  201 :
  202 :
  203 : [u313c,v313c,p313c,f313c,g313c]=[conj(u313),conj(v313),conj(p313),conj(f313),conj(g313)];
  204 : ys313c=conj(ys313);vs313c=conj(vs313);
  205 :
  206 :
  207 : ///////////////////////////////////////
  208 : ///// Ordre3:  Mode AAA  - 33    //////
  209 : ///////////////////////////////////////
  210 :
  211 : {
  212 : ifstream file(pathwnl+namewnl3AAA);
  213 : file >> sol ;
  214 : };
  215 :
  216 : u33[]=sol(0:nff-1);
  217 : ys33=sol(nft-2); vs33=sol(nft-1);
  218 :
  219 :
  220 : [u33c,v33c,p33c,f33c,g33c]=[conj(u33),conj(v33),conj(p33),conj(f33),conj(g33)];
  221 : ys33c=conj(ys33);vs33c=conj(vs33);
  222 :
  223 :
  224 : /////////////////////////////////////////////
  225 : ///// Ordre4:  Mode deltaAAc  - 402    //////
  226 : ///////////////////////////////////////
  227 :
  228 : {
  229 : ifstream file(pathwnl+namewnl4DeltaAAc);
  230 : file >> sol ;
  231 : };
  232 :
  233 : u402[]=sol(0:nff-1);
  234 : ys402=sol(nft-2); vs402=sol(nft-1);
  235 :
  236 :
  237 : /////////////////////////////////////////////
  238 : ///// Ordre4:  Mode AAcAAc  - 404    //////
  239 : ///////////////////////////////////////
  240 :
  241 : {
  242 : ifstream file(pathwnl+namewnl4AAcAAc);
  243 : file >> sol ;
  244 : };
  245 :
  246 : u404[]=sol(0:nff-1);
  247 : ys404=sol(nft-2); vs404=sol(nft-1);
  248 :
  249 : ////////////////////////////////////////////
  250 : ///// Ordre4:  Mode deltaAA  - 422    //////
  251 : ///////////////////////////////////////
  252 :
  253 : {
  254 : ifstream file(pathwnl+namewnl4DeltaAA);
  255 : file >> sol ;
  256 : };
  257 :
  258 : u422[]=sol(0:nff-1);
  259 : ys422=sol(nft-2); vs422=sol(nft-1);
  260 :
  261 :
  262 : ////////////////////////////////////////////
  263 : ///// Ordre4:  Mode AAAAc  - 424    //////
  264 : ///////////////////////////////////////
  265 :
  266 : {
  267 : ifstream file(pathwnl+namewnl4AAAAc);
  268 : file >> sol ;
  269 : };
  270 :
  271 : u424[]=sol(0:nff-1);
  272 : ys424=sol(nft-2); vs424=sol(nft-1);
  273 :
  274 : ////////////////////////////////////////////
  275 : ///// Ordre4:  Mode AAAA  - 44    //////
  276 : ///////////////////////////////////////
  277 :
  278 : {
  279 : ifstream file(pathwnl+namewnl4AAAA);
  280 : file >> sol ;
  281 : };
  282 :
  283 : u44[]=sol(0:nff-1);
  284 : ys44=sol(nft-2); vs44=sol(nft-1);
  285 :
  286 :
  287 : ////////////////////////////////
  288 : ///// Adjoint  Mode A   ///////
  289 : ///////////////////////////////
  290 :
  291 :
  292 : {
  293 : ifstream file(pathmode+namemodeadj);
  294 :  file >> eig ;
  295 :  file >> sol ;
  296 : };
  297 :
  298 : au1[]=sol(0:nff-1); ays1=sol(nft-2); avs1=sol(nft-1);
  299 :
  300 :
  301 : cout << "Adj-eigA= " << eig << endl;
  302 :
  303 : complex Normeaf,Normeas,Normea;
  304 :
  305 : Normeaf=int2d(th)(conj(au1)*u1+conj(av1)*v1);
  306 : Normeas=conj(ays1)*ys1+conj(avs1)*vs1;
  307 :
  308 : Normea=Normeaf+Normeas;
  309 :
  310 : au1[]*=1/conj(Normea);
  311 : ays1*=1./conj(Normea);
  312 : avs1*=1./conj(Normea);
  313 :
  314 : Normeaf=int2d(th)(conj(au1)*u1+conj(av1)*v1);
  315 : Normeas=conj(ays1)*ys1+conj(avs1)*vs1;
  316 :
  317 : Normea=Normeaf+Normeas;
  318 :
  319 : cout << "Normeaf= " << Normeaf << endl;
  320 : cout << "Normeas= " << Normeas << endl;
  321 : cout << "Normea= " << Normea << endl;
  322 :
  323 : [ur,vr,pr,fr,gr]=[real(au1),real(av1),real(ap1),real(af1),real(ag1)];
  324 : plot(ur,value=1,wait=1,cmm="Adj-u1-r");
  325 :
  326 :
  327 : complex alpha1=-conj(avs1)*(ys311);
  328 : complex beta1=-conj(avs1)*(ys313);
  329 :
  330 :
  331 : cout << "-------------------------------------" << endl;
  332 : cout << "alpha-1  = " << alpha1 << endl;
  333 : cout << "beta-1   = " << beta1 << endl;
  334 : cout << "-------------------------------------" << endl;
  335 :
  336 : complex beta2,gamma;
  337 :
  338 : beta2=-int2d(th)(
  339 : conj(au1)*( u22*dx(u311c)+v22*dy(u311c) )
  340 : +conj(au1)*( u311c*dx(u22)+v311c*dy(u22) )
  341 : +conj(au1)*( u20*dx(u311)+v20*dy(u311) )
  342 : +conj(au1)*( u311*dx(u20)+v311*dy(u20) )
  343 : +conj(au1)*( u402*dx(u1)+v402*dy(u1) )
  344 : +conj(au1)*( u1*dx(u402)+v1*dy(u402) )
  345 : +conj(au1)*( u422*dx(u1c)+v422*dy(u1c) )
  346 : +conj(au1)*( u1c*dx(u422)+v1c*dy(u422) )
  347 : +conj(av1)*( u22*dx(v311c)+v22*dy(v311c) )
  348 : +conj(av1)*( u311c*dx(v22)+v311c*dy(v22) )
  349 : +conj(av1)*( u20*dx(v311)+v20*dy(v311) )
  350 : +conj(av1)*( u311*dx(v20)+v311*dy(v20) )
  351 : +conj(av1)*( u402*dx(v1)+v402*dy(v1) )
  352 : +conj(av1)*( u1*dx(v402)+v1*dy(v402) )
  353 : +conj(av1)*( u422*dx(v1c)+v422*dy(v1c) )
  354 : +conj(av1)*( u1c*dx(v422)+v1c*dy(v422) )
  355 : );
  356 :
  357 :
  358 : gamma=-int2d(th)(
  359 : conj(au1)*( u22*dx(u313c)+v22*dy(u313c) )
  360 : +conj(au1)*( u313c*dx(u22)+v313c*dy(u22) )
  361 : +conj(au1)*( u20*dx(u313)+v20*dy(u313) )
  362 : +conj(au1)*( u313*dx(u20)+v313*dy(u20) )
  363 : +conj(au1)*( u22c*dx(u33)+v22c*dy(u33) )
  364 : +conj(au1)*( u33c*dx(u22c)+v33*dy(u22c) )
  365 : +conj(au1)*( u404*dx(u1)+v404*dy(u1) )
  366 : +conj(au1)*( u1*dx(u404)+v1*dy(u404) )
  367 : +conj(au1)*( u424*dx(u1c)+v424*dy(u1c) )
  368 : +conj(au1)*( u1c*dx(u424)+v1c*dy(u424) )
  369 : +conj(av1)*( u22*dx(v313c)+v22*dy(v313c) )
  370 : +conj(av1)*( u313c*dx(v22)+v313c*dy(v22) )
  371 : +conj(av1)*( u20*dx(v313)+v20*dy(v313) )
  372 : +conj(av1)*( u313*dx(v20)+v313*dy(v20) )
  373 : +conj(av1)*( u22c*dx(v33)+v22c*dy(v33) )
  374 : +conj(av1)*( u33c*dx(v22c)+v33*dy(v22c) )
  375 : +conj(av1)*( u404*dx(v1)+v404*dy(v1) )
  376 : +conj(av1)*( u1*dx(v404)+v1*dy(v404) )
  377 : +conj(av1)*( u424*dx(v1c)+v424*dy(v1c) )
  378 : +conj(av1)*( u1c*dx(v424)+v1c*dy(v424) )
  379 : );
  380 :
  381 : cout << "-------------------------------------" << endl;
  382 : cout << "beta-2  = " << beta2 << endl;
  383 : cout << "gamma   = " << gamma << endl;
  384 : cout << "-------------------------------------" << endl;
  385 :
  386 : {
  387 : ofstream file(pathwnl+namewnl5Coeffs);
  388 : file << alpha1 << endl;
  389 : file << beta1 << endl;
  390 : file << beta2 << endl;
  391 : file << gamma << endl;
  392 : };
  393 :
  394 :
  395 :  sizestack + 1024 =10296  ( 9272 )
 
-----------------------------------------
--- Re        =  40
--- rhos/rhof =  50
--- omegas    =  0.657
-----------------------------------------
  --  mesh:  Nb of Triangles =  31727, Nb of Vertices 15955
eigA= (-9.29136e-006,0.662728)
Adj-eigA= (-9.29136e-006,-0.662728)
Normeaf= (-0.14082,0.133355)
Normeas= (1.14082,-0.133355)
Normea= (1,-7.21645e-016)
-------------------------------------
alpha-1  = (1.93459,0.235517)
beta-1   = (-0.0117784,-0.0235002)
-------------------------------------
-------------------------------------
beta-2  = (-0.03236,-0.0455634)
gamma   = (0.000646466,0.00138457)
-------------------------------------
times: compile 0.555s, execution 51.631s,  mpirank:0
 ######## We forget of deleting   894 Nb pointer,   0Bytes  ,  mpirank 0, memory leak =0
 CodeAlloc : nb ptr  4862,  size :417208 mpirank: 0
Ok: Normal End
 try getConsole D:\marquet\Desktop\Etudes\SpringCylinder-WNL\wnl-wbc\Codes-wnl\FS-ordre-5-Coeffs.edp
