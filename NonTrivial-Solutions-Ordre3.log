-- FreeFem++ v  3.530000 (date mar. 25 avr. 2017 10:07:35)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : load "MUMPS_seq"(load: loadLibary C:\Program Files (x86)\FreeFem++\\.\MUMPS_seq = 0)
    2 :
    3 : //////////////////
    4 : //  Parametres ///
    5 : //////////////////
    6 :
    7 : real rho=50;
    8 : real Rec=40;
    9 : real omegasc=0.657;
   10 : real gammas=0.0;
   11 : int nummesh=22;
   12 :
   13 : real omegasmin=0.5;
   14 : real domegas=0.001;
   15 : real omegasmax=0.8;
   16 : real omegas=omegasmin;
   17 :
   18 :
   19 : int mode=1;
   20 : int modeadj=1;
   21 :
   22 : complex alpha,alpha1,beta,beta1,beta2,gamma;
   23 : complex alphat,betat;
   24 : complex eig;
   25 : real lambdac,omegac;
   26 :
   27 : string pathmesh="mesh/";
   28 : string pathbaseflow="baseflow/";
   29 : string pathmode="stabilite/";
   30 : string pathwnl="wnl/";
   31 :
   32 : string namemesh="mesh-"+nummesh+".msh";
   33 : string namebaseflow="Baseflow-"+nummesh+"-Re-"+Rec+".txt";
   34 : string namemode="Dir-Mode-Re-"+Rec+"-rho-"+rho+"-gammas-"+gammas+"-omegas-"+omegasc+"-mesh-"+nummesh+"-num-"+mode+".dat";
   35 : string namemodeadj="Adj-Mode-Re-"+Rec+"-rho-"+rho+"-gammas-"+gammas+"-omegas-"+omegasc+"-mesh-"+nummesh+"-num-"+mode+".dat";
   36 :
   37 : string namewnl3Coeffs="Coeffs-Ordre3-Re-"+Rec+"-rho-"+rho+"-gammas-"+gammas+"-omegas-"+omegasc+"-mesh-"+nummesh+"-num-"+mode+".dat";
   38 :
   39 :
   40 : string nameeig3="Eigenvalue-Ordre3-Re-"+Rec+"-rho-"+rho+"-gammas-"+gammas+"-omegas-"+omegasc+"-mesh-"+nummesh+"-num-"+mode+".dat";
   41 :
   42 : string nameampli3="Amplitude-Ordre3-Ordre5-Re-"+Rec+"-rho-"+rho+"-gammas-"+gammas+"-omegas-"+omegasc+"-mesh-"+nummesh+"-num-"+mode+".dat";
   43 :
   44 :
   45 : mesh th=readmesh(pathmesh+namemesh);
   46 :
   47 : fespace fuuppp(th,[P1b,P1b,P1,P1,P1]);
   48 :
   49 : complex ysd,vsd;
   50 : int ndoff=fuuppp.ndof;
   51 : int ndoft=ndoff+2;
   52 : complex[int] vect(ndoft);
   53 :
   54 : {
   55 : ifstream filev(pathmode+namemode);
   56 : filev >> eig ;
   57 : filev >> vect(:) ;
   58 : };
   59 :
   60 : lambdac=real(eig); omegac=imag(eig);
   61 : ysd=vect(ndoff);
   62 :
   63 :
   64 : {
   65 : ifstream file(pathwnl+namewnl3Coeffs);
   66 : file >> alpha ;
   67 : file >> beta ;
   68 : };
   69 :
   70 :
   71 : cout << "ksc      = " << omegasc << endl;
   72 : cout << "omegac   = " << omegac << endl;
   73 : cout << "alpha    = " << alpha << endl;
   74 : cout << "beta     = " << beta << endl;
   75 : cout << "abs(ysd) = " << abs(ysd) << endl;
   76 :
   77 :
   78 : //////////////////   Lineaire /////////////////////////
   79 :
   80 : {
   81 : ofstream file3(pathwnl+nameeig3);
   82 :
   83 :
   84 : real lambda,omega;
   85 :
   86 : while(omegas<=omegasmax)
   87 : {
   88 :
   89 :  lambda=(omegas*omegas-omegasc*omegasc)*real(alpha);
   90 :  omega=omegac+(omegas*omegas-omegasc*omegasc)*imag(alpha);
   91 :
   92 :  file3 << omegas << " " << lambda << " " << omega << endl;
   93 :
   94 :  omegas+=domegas;
   95 :
   96 : };
   97 :
   98 : };
   99 :
  100 :
  101 :
  102 : real Delta;
  103 : real Xp,Xm,Ap,Am;
  104 :
  105 : //////////////  Non lineaire - Ordre3  //////////////////////
  106 :
  107 : real omegal,omeganl,ysmax;
  108 :
  109 : omegas=omegasmin;
  110 :
  111 :
  112 : {
  113 : ofstream file3(pathwnl+nameampli3);
  114 :
  115 :
  116 : while(omegas<=omegasmax)
  117 : {
  118 :
  119 :  Ap=real(alpha)/real(beta)*(omegas*omegas-omegasc*omegasc);
  120 :
  121 :  if(Ap>=0)
  122 :  {
  123 :  omegal=omegac+(omegas*omegas-omegasc*omegasc)*imag(alpha);
  124 :  omeganl=omegal-imag(beta)*Ap;
  125 :  ysmax=2*sqrt(Ap)*abs(ysd);
  126 :
  127 :  file3 << omegas << " " << sqrt(Ap) << " " << -sqrt(Ap) << " " << omeganl << endl;
  128 :
  129 :
  130 :  };
  131 :
  132 :  omegas+=domegas;
  133 :
  134 : };
  135 :
  136 :
  137 : };
  138 :
  139 :  sizestack + 1024 =3168  ( 2144 )
 
  --  mesh:  Nb of Triangles =  31727, Nb of Vertices 15955
ksc      = 0.657
omegac   = 0.662728
alpha    = (0.101485,0.868171)
beta     = (9.74515e-005,0.00170807)
abs(ysd) = 0.0101495
times: compile 0.196s, execution 1.584s,  mpirank:0
 ######## We forget of deleting   3251 Nb pointer,   0Bytes  ,  mpirank 0, memory leak =0
 CodeAlloc : nb ptr  3190,  size :374872 mpirank: 0
Ok: Normal End
 try getConsole D:\marquet\Desktop\Etudes\SpringCylinder-WNL\wnl-wbc\Codes-wnl\NonTrivial-Solutions-Ordre3.edp
